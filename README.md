# UdpTest

Проект состоит из 3х комнонент

Client - клиент

Server - сервер

Common - статическая библиотека. Общий код для клиента и сервера(Утилиты, протокол, работа с сокетами)

Сборка проекта(делал с помощью CMake)

mkdir build

cd build

cmake ..

make

Для теста запускаем скрипты из корневой папки.
сначала
runServer.sh
затем
runClient.sh

По умолчанию приложения запускаются с адресом 127.0.0.1(тестировал на одном компьютере) и портом 40000
Для изменений можно добавить параметры запуска 
-a <ip> -p <port>
Пример:
-a 192.168.1.1 -p 45000

Файлы, с которыми работает клиент лежат в корне репозитория, это две картинки(были использованы для тестов)
test1.jpeg и test2.jpg
Пути к файлам передаются клиенту в командной строке с параметром -f(в скрипте runClient.sh они уже указаны)
Пример:
-f test1.jpeg -f test2.jpg

После запуска клиент создает файлы в памяти в виде структур с данными, разбивает их на пакеты, указанные в ТЗ
(в качестве byte id[8] я использовал тип uint64_t и брал случайное число при создании файла),
перемешивает пакеты в случайном порядке и отправляет на сервер.
Вывод осуществляетя в консоль, можно наблюдать информацию об отправке/примеме сообщений.
Пример:
 
>Sending id: 6987235383447705861 type: 1 num: 2 / 3
 
>Received id: 3447901547625043407 type: 0 num: 0 / 1
 
type 1 = PUT, type 0 = ACK, id - случайно сгенеренный id для файла num - <индекс пакета>/<количество>
 
Когда клиент получает в последнем пакете crc от сервера выводится сообщение такого вида:
>Received crc from server id: 6987235383447705861 crc: 3275490554 Local crc: 3275490554 Valid

Когда получим  crc для всех файлов, клиент прекращает работу. Сервер работает всегда, нужно завершать принудительно.
После завершения работы клиента, можно его перезапустить с другими параметрами. Сервер продолжит работу.
  
Есть также параметр запуска -d, в котором и клиенту и серверу можно выставить вероятность
игнорирования пакета для тестирования ситуации, когда сервер либо не получил пакет от клиента, либо когда клиент не получил ответ от сервера.
Вероятность в процентах от 1 до 100
Пример:
 
 -d 50 (50% пакетов будет "потеряно")
 
В этом случае в консоли будут сообщения вида:
>Packet dropped id: 11346329653716594434 type: 0 num: 1217 / 1753

>Resending id: 11346329653716594434 type: 1 num: 485 / 1753
